<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>热门头条展示</title>
    <script>

        // 使用新的API获取微博热搜
        async function getWeiboHotKeywords() {
            const response = await fetch('https://v2.xxapi.cn/api/weibohot');
            const data = await response.json();
            return data.data.map(item => item.title); // 假设返回的JSON中有data字段
        }

        function generateRandomString(length) {
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let result = '';
            for (let i = 0; i < length; i++) {
                result += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            return result;
        }

        // 在页面上展示微博热搜
        async function displayWeiboKeywords() {
            const keywords = await getWeiboHotKeywords();

            // 获取用户设置的间隔
            const minInterval = parseInt(document.getElementById('minInterval').value, 10) * 1000;
            const maxInterval = parseInt(document.getElementById('maxInterval').value, 10) * 1000;

            // 每隔随机间隔发起一次Bing搜索
            let index = 0;
            const intervalId = setInterval(() => {
                if (index < keywords.length) {
                    const keyword = keywords[index];
                    const searchUrl = `https://www.bing.com/search?q=${encodeURIComponent(keyword)}&FORM=EDGSPH`;
                    window.open(searchUrl, '_blank');
                    index++;
                } else {
                    clearInterval(intervalId); // 停止定时器
                }
            }, Math.random() * (maxInterval - minInterval) + minInterval);
        }

        // 页面加载后设置按钮点击事件
        window.onload = function() {
            document.getElementById('startSearch').onclick = displayWeiboKeywords;
        }
    </script>
</head>
<body>
    <h1>当前热门头条</h1>
    <ul id="keywordList">
        <!-- 热门头条将显示在这里 -->
    </ul>
    <div>
        <label for="minInterval">最小间隔（秒）:</label>
        <input type="number" id="minInterval" value="5">
        <label for="maxInterval">最大间隔（秒）:</label>
        <input type="number" id="maxInterval" value="20">
        <button id="startSearch">开始搜索</button>
    </div>
</body>
</html>
